import{i as Ie,k as Me,s as q,P as Q,l as pe,_ as S,m as Ee,r as m,n as ze,o as Ve,j as e,p as ae,q as Le,c as E,u as Be,a as qe,b as We,d as De,L as Re,C as $e,B as c,I as Z,T as a,f as A,g as I,e as Ue,E as K,Q as n,F as M,t as ne}from"./index-7eb3e469.js";import{A as _e}from"./ArrowBack-94ac059f.js";import{S as Ze,a as le,b as ce}from"./Stepper-5f6625b9.js";import{L as Ke}from"./LinearProgress-1489282b.js";import{P as Y}from"./Person-205868f6.js";import{L as H}from"./Lock-d70a65ee.js";import{F as g,I as v,O as P}from"./OutlinedInput-42254326.js";import{I as f}from"./InputAdornment-796da98e.js";import{F as w}from"./FormHelperText-b8c529e9.js";import{V as de,a as me}from"./VisibilityOff-ba84383b.js";function Ye(t){return Ie("MuiMobileStepper",t)}Me("MuiMobileStepper",["root","positionBottom","positionTop","positionStatic","dots","dot","dotActive","progress"]);const He=["activeStep","backButton","className","LinearProgressProps","nextButton","position","steps","variant"],Qe=t=>{const{classes:l,position:u}=t,b={root:["root",`position${pe(u)}`],dots:["dots"],dot:["dot"],dotActive:["dotActive"],progress:["progress"]};return Le(b,Ye,l)},Ge=q(Q,{name:"MuiMobileStepper",slot:"Root",overridesResolver:(t,l)=>{const{ownerState:u}=t;return[l.root,l[`position${pe(u.position)}`]]}})(({theme:t,ownerState:l})=>S({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:(t.vars||t).palette.background.default,padding:8},l.position==="bottom"&&{position:"fixed",bottom:0,left:0,right:0,zIndex:(t.vars||t).zIndex.mobileStepper},l.position==="top"&&{position:"fixed",top:0,left:0,right:0,zIndex:(t.vars||t).zIndex.mobileStepper})),Je=q("div",{name:"MuiMobileStepper",slot:"Dots",overridesResolver:(t,l)=>l.dots})(({ownerState:t})=>S({},t.variant==="dots"&&{display:"flex",flexDirection:"row"})),Xe=q("div",{name:"MuiMobileStepper",slot:"Dot",shouldForwardProp:t=>Ee(t)&&t!=="dotActive",overridesResolver:(t,l)=>{const{dotActive:u}=t;return[l.dot,u&&l.dotActive]}})(({theme:t,ownerState:l,dotActive:u})=>S({},l.variant==="dots"&&S({transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),backgroundColor:(t.vars||t).palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"},u&&{backgroundColor:(t.vars||t).palette.primary.main}))),es=q(Ke,{name:"MuiMobileStepper",slot:"Progress",overridesResolver:(t,l)=>l.progress})(({ownerState:t})=>S({},t.variant==="progress"&&{width:"50%"})),ss=m.forwardRef(function(l,u){const b=ze({props:l,name:"MuiMobileStepper"}),{activeStep:F=0,backButton:p,className:G,LinearProgressProps:h,nextButton:z,position:V="bottom",steps:O,variant:r="dots"}=b,W=Ve(b,He),i=S({},b,{activeStep:F,position:V,variant:r});let N;r==="progress"&&(O===1?N=100:N=Math.ceil(F/(O-1)*100));const x=Qe(i);return e.jsxs(Ge,S({square:!0,elevation:0,className:ae(x.root,G),ref:u,ownerState:i},W,{children:[p,r==="text"&&e.jsxs(m.Fragment,{children:[F+1," / ",O]}),r==="dots"&&e.jsx(Je,{ownerState:i,className:x.dots,children:[...new Array(O)].map((D,d)=>e.jsx(Xe,{className:ae(x.dot,d===F&&x.dotActive),ownerState:i,dotActive:d===F},d))}),r==="progress"&&e.jsx(es,S({ownerState:i,className:x.progress,variant:"determinate",value:N},h)),z]}))}),rs=ss,ue=E(e.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),ts=E(e.jsx("path",{fillRule:"evenodd",d:"m9 17 3-2.94c-.39-.04-.68-.06-1-.06-2.67 0-8 1.34-8 4v2h9zm2-5c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m4.47 8.5L12 17l1.4-1.41 2.07 2.08 5.13-5.17 1.4 1.41z"}),"HowToReg"),is=E(e.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft"),os=E(e.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight"),as=E(e.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm-2 16-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"VerifiedUser");function bs(){var oe;const{signup:t,verifyOtp:l,sendOtpByEmail:u,sendOtpBySms:b,setskipemailotp:F,skipemailotp:p,setskipsmsotp:G,skipsmsotp:h}=Be(),z=qe(),V=We(),O=De(V.breakpoints.down("sm")),[r,W]=m.useState({firstName:"",lastName:"",email:"",phoneNumber:"",password:"",confirmPassword:"",emailOtp:"",phoneOtp:""}),[i,N]=m.useState({}),[x,D]=m.useState(!1),[d,J]=m.useState(0),[R,he]=m.useState(!1),[$,fe]=m.useState(!1),[xe,be]=m.useState(!1),[je,ye]=m.useState(!1),[C,X]=m.useState(!1),[k,ee]=m.useState(!1),[se,L]=m.useState(!1),[re,B]=m.useState(!1),[U,te]=m.useState(!1),[_,ie]=m.useState(!1),T=[{label:"Name",fields:["firstName","lastName"],icon:e.jsx(Y,{})},{label:"Contact",fields:["email","phoneNumber"],icon:e.jsx(K,{})},{label:"Security",fields:["password","confirmPassword"],icon:e.jsx(H,{})},{label:"Verify",fields:["emailOtp","phoneOtp"],icon:e.jsx(as,{})}],j=((oe=T[d])==null?void 0:oe.fields)||[];m.useEffect(()=>{p&&X(!0),h&&ee(!0)},[p,h]);const y=s=>{const{name:o,value:Te}=s.target;W({...r,[o]:Te}),i[o]&&N({...i,[o]:null})},ge=()=>{let s={},o=!0;return j.includes("firstName")&&!r.firstName.trim()&&(s.firstName="First name is required",o=!1),j.includes("lastName")&&!r.lastName.trim()&&(s.lastName="Last name is required",o=!1),j.includes("email")&&(r.email.trim()?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(r.email)||(s.email="Please enter a valid email address",o=!1):(s.email="Email is required",o=!1)),j.includes("phoneNumber")&&(r.phoneNumber.trim()?/^[0-9]{10}$/.test(r.phoneNumber)||(s.phoneNumber="Please enter a valid 10-digit phone number",o=!1):(s.phoneNumber="Phone number is required",o=!1)),j.includes("password")&&(r.password?r.password.length<6&&(s.password="Password must be at least 6 characters",o=!1):(s.password="Password is required",o=!1)),j.includes("confirmPassword")&&(r.confirmPassword?r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match",o=!1):(s.confirmPassword="Please confirm your password",o=!1)),j.includes("emailOtp")&&!p&&!C&&(r.emailOtp.trim()?/^[0-9]{6}$/.test(r.emailOtp)||(s.emailOtp="OTP must be 6 digits",o=!1):(s.emailOtp="Email OTP is required",o=!1)),j.includes("phoneOtp")&&!h&&!k&&(r.phoneOtp.trim()?/^[0-9]{6}$/.test(r.phoneOtp)||(s.phoneOtp="OTP must be 6 digits",o=!1):(s.phoneOtp="Phone OTP is required",o=!1)),N(s),o},ve=()=>{let s={};return r.firstName.trim()||(s.firstName="First name is required"),r.lastName.trim()||(s.lastName="Last name is required"),r.email.trim()?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(r.email)||(s.email="Please enter a valid email address"):s.email="Email is required",r.phoneNumber.trim()?/^[0-9]{10}$/.test(r.phoneNumber)||(s.phoneNumber="Please enter a valid 10-digit phone number"):s.phoneNumber="Phone number is required",r.password?r.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required",r.confirmPassword?r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",N(s),Object.keys(s).length===0},Pe=()=>{ge()&&(d===2&&Se(),J(s=>s+1))},we=()=>{J(s=>s-1)},Se=async()=>{if(!p&&!xe){L(!0);try{const s=await u(r.email);s!=null&&s.valid?(be(!0),n.success("OTP sent to your email")):n.error((s==null?void 0:s.message)||"Failed to send email OTP")}catch(s){console.error("Email OTP error:",s),n.error("Failed to send email OTP")}finally{L(!1)}}if(!h&&!je){B(!0);try{const s=await b(r.phoneNumber);s!=null&&s.valid?(ye(!0),n.success("OTP sent to your phone")):n.error((s==null?void 0:s.message)||"Failed to send SMS OTP")}catch(s){console.error("SMS OTP error:",s),n.error("Failed to send SMS OTP")}finally{B(!1)}}},Oe=async()=>{if(r.emailOtp.trim()&&!C){te(!0);try{const s=await l(r.email,r.emailOtp);s!=null&&s.valid?(X(!0),n.success("Email verified successfully")):n.error((s==null?void 0:s.message)||"Invalid email OTP")}catch(s){console.error("Email verification error:",s),n.error("Email verification failed")}finally{te(!1)}}},Ne=async()=>{if(r.phoneOtp.trim()&&!k){ie(!0);try{const s=await l(r.phoneNumber,r.phoneOtp);s!=null&&s.valid?(ee(!0),n.success("Phone verified successfully")):n.error((s==null?void 0:s.message)||"Invalid phone OTP")}catch(s){console.error("Phone verification error:",s),n.error("Phone verification failed")}finally{ie(!1)}}},Ce=async()=>{L(!0);try{const s=await u(r.email);s!=null&&s.valid?n.success("OTP resent to your email"):n.error((s==null?void 0:s.message)||"Failed to resend email OTP")}catch(s){console.error("Email OTP error:",s),n.error("Failed to resend email OTP")}finally{L(!1)}},ke=async()=>{B(!0);try{const s=await b(r.phoneNumber);s!=null&&s.valid?n.success("OTP resent to your phone"):n.error((s==null?void 0:s.message)||"Failed to resend SMS OTP")}catch(s){console.error("SMS OTP error:",s),n.error("Failed to resend SMS OTP")}finally{B(!1)}},Ae=async s=>{if(s.preventDefault(),d===T.length&&(!p&&!C||!h&&!k)){n.error("Please verify your email and phone number");return}if(ve()){D(!0);try{const o=await t(r);o!=null&&o.valid?(n.success("Account created successfully!"),setTimeout(()=>z("/login"),2e3)):n.error((o==null?void 0:o.message)||"Registration failed. Please try again.")}catch(o){console.error("Signup error:",o),n.error("Registration failed. Please try again later.")}finally{D(!1)}}},Fe=s=>{switch(s){case 0:return e.jsx(M,{in:d===0,timeout:500,children:e.jsxs(c,{children:[e.jsx(a,{variant:"h6",gutterBottom:!0,color:"primary",children:"Let's get started with your name"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Please enter your first and last name as it appears on your official documents."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.firstName,children:[e.jsx(v,{htmlFor:"firstName",children:"First Name"}),e.jsx(P,{id:"firstName",name:"firstName",value:r.firstName,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(Y,{color:"action"})}),label:"First Name",autoFocus:!0}),i.firstName&&e.jsx(w,{children:i.firstName})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.lastName,children:[e.jsx(v,{htmlFor:"lastName",children:"Last Name"}),e.jsx(P,{id:"lastName",name:"lastName",value:r.lastName,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(Y,{color:"action"})}),label:"Last Name"}),i.lastName&&e.jsx(w,{children:i.lastName})]})]})});case 1:return e.jsx(M,{in:d===1,timeout:500,children:e.jsxs(c,{children:[e.jsx(a,{variant:"h6",gutterBottom:!0,color:"primary",children:"Your contact information"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"We'll use these details to verify your account and keep you updated."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.email,children:[e.jsx(v,{htmlFor:"email",children:"Email Address"}),e.jsx(P,{id:"email",type:"email",name:"email",value:r.email,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(K,{color:"action"})}),label:"Email Address",autoFocus:!0}),i.email&&e.jsx(w,{children:i.email})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.phoneNumber,children:[e.jsx(v,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(P,{id:"phoneNumber",name:"phoneNumber",value:r.phoneNumber,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(ne,{color:"action"})}),label:"Phone Number"}),i.phoneNumber&&e.jsx(w,{children:i.phoneNumber})]})]})});case 2:return e.jsx(M,{in:d===2,timeout:500,children:e.jsxs(c,{children:[e.jsx(a,{variant:"h6",gutterBottom:!0,color:"primary",children:"Create a secure password"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Your password should be at least 6 characters long and include a mix of letters and numbers."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.password,children:[e.jsx(v,{htmlFor:"password",children:"Password"}),e.jsx(P,{id:"password",type:R?"text":"password",name:"password",value:r.password,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(H,{color:"action"})}),endAdornment:e.jsx(f,{position:"end",children:e.jsx(Z,{"aria-label":"toggle password visibility",onClick:()=>he(!R),edge:"end",children:R?e.jsx(de,{}):e.jsx(me,{})})}),label:"Password",autoFocus:!0}),i.password&&e.jsx(w,{children:i.password})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.confirmPassword,children:[e.jsx(v,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(P,{id:"confirmPassword",type:$?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(H,{color:"action"})}),endAdornment:e.jsx(f,{position:"end",children:e.jsx(Z,{"aria-label":"toggle confirm password visibility",onClick:()=>fe(!$),edge:"end",children:$?e.jsx(de,{}):e.jsx(me,{})})}),label:"Confirm Password"}),i.confirmPassword&&e.jsx(w,{children:i.confirmPassword})]})]})});case 3:return e.jsx(M,{in:d===3,timeout:500,children:e.jsxs(c,{children:[e.jsx(a,{variant:"h6",gutterBottom:!0,color:"primary",children:"Verify your contact information"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Enter the verification codes sent to your email and phone number."}),!p&&e.jsxs(c,{sx:{mb:3},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(K,{color:"primary",sx:{mr:1}}),e.jsx(a,{variant:"subtitle1",children:"Email Verification"}),C&&e.jsxs(c,{sx:{ml:1,display:"flex",alignItems:"center",color:"success.main"},children:[e.jsx(ue,{fontSize:"small"}),e.jsx(a,{variant:"body2",color:"success.main",children:"Verified"})]})]}),C?e.jsx(a,{variant:"body2",color:"success.main",sx:{mt:1},children:"Your email has been successfully verified."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.emailOtp,children:[e.jsx(v,{htmlFor:"emailOtp",children:"Email OTP"}),e.jsx(P,{id:"emailOtp",name:"emailOtp",value:r.emailOtp,onChange:y,label:"Email OTP",disabled:U,endAdornment:e.jsx(f,{position:"end",children:e.jsx(A,{variant:"text",size:"small",onClick:Oe,disabled:!r.emailOtp||U,children:U?e.jsx(I,{size:20}):"Verify"})})}),i.emailOtp&&e.jsx(w,{children:i.emailOtp})]}),e.jsx(A,{variant:"text",size:"small",onClick:Ce,disabled:se,sx:{mt:1},children:se?e.jsx(I,{size:20}):"Resend OTP"})]})]}),!h&&e.jsxs(c,{children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ne,{color:"primary",sx:{mr:1}}),e.jsx(a,{variant:"subtitle1",children:"Phone Verification"}),k&&e.jsxs(c,{sx:{ml:1,display:"flex",alignItems:"center",color:"success.main"},children:[e.jsx(ue,{fontSize:"small"}),e.jsx(a,{variant:"body2",color:"success.main",children:"Verified"})]})]}),k?e.jsx(a,{variant:"body2",color:"success.main",sx:{mt:1},children:"Your phone number has been successfully verified."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.phoneOtp,children:[e.jsx(v,{htmlFor:"phoneOtp",children:"Phone OTP"}),e.jsx(P,{id:"phoneOtp",name:"phoneOtp",value:r.phoneOtp,onChange:y,label:"Phone OTP",disabled:_,endAdornment:e.jsx(f,{position:"end",children:e.jsx(A,{variant:"text",size:"small",onClick:Ne,disabled:!r.phoneOtp||_,children:_?e.jsx(I,{size:20}):"Verify"})})}),i.phoneOtp&&e.jsx(w,{children:i.phoneOtp})]}),e.jsx(A,{variant:"text",size:"small",onClick:ke,disabled:re,sx:{mt:1},children:re?e.jsx(I,{size:20}):"Resend OTP"})]})]}),p&&h&&e.jsx(a,{variant:"body2",color:"info.main",sx:{mt:3},children:"Verification step has been skipped based on system configuration."})]})});case 4:return e.jsx(M,{in:d===4,timeout:500,children:e.jsxs(c,{sx:{textAlign:"center",py:2},children:[e.jsx(ts,{color:"success",sx:{fontSize:60,mb:2}}),e.jsx(a,{variant:"h5",gutterBottom:!0,color:"primary",fontWeight:"bold",children:"Ready to create your account"}),e.jsx(a,{variant:"body1",sx:{mb:2},children:"Please review your information before submitting:"}),e.jsxs(Q,{variant:"outlined",sx:{p:2,mb:3,bgcolor:"background.default"},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Name:"}),e.jsxs(a,{variant:"body2",children:[r.firstName," ",r.lastName]})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Email:"}),e.jsx(a,{variant:"body2",children:r.email})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Phone:"}),e.jsx(a,{variant:"body2",children:r.phoneNumber})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Verification Status:"}),e.jsxs(c,{children:[!p&&e.jsxs(a,{variant:"body2",color:C?"success.main":"error.main",children:["Email: ",C?"Verified":"Not Verified"]}),!h&&e.jsxs(a,{variant:"body2",color:k?"success.main":"error.main",children:["Phone: ",k?"Verified":"Not Verified"]}),p&&h&&e.jsx(a,{variant:"body2",children:"Verification Skipped"})]})]})]}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:'By clicking "Create Account", you agree to our Terms of Service and Privacy Policy.'})]})});default:return null}};return e.jsx(Re,{title:"Dmarg - Sign Up",children:e.jsxs($e,{maxWidth:"sm",sx:{py:{xs:2,sm:4}},children:[e.jsxs(c,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(Z,{onClick:()=>z("/login"),sx:{color:"primary.main"},children:e.jsx(_e,{})}),e.jsx(a,{variant:"h5",component:"h1",fontWeight:"bold",textAlign:"center",sx:{flex:1},children:"Create Account"}),e.jsx(c,{sx:{width:40}})," "]}),e.jsxs(Q,{elevation:2,sx:{borderRadius:2,overflow:"hidden",backgroundColor:"background.paper"},children:[!O&&e.jsxs(Ze,{activeStep:d,alternativeLabel:!0,sx:{pt:3,pb:2,px:2,bgcolor:"background.subtle"},children:[T.map((s,o)=>e.jsx(le,{children:e.jsx(ce,{StepIconProps:{icon:o===d?s.icon:o<d?"✓":o+1},children:s.label})},s.label)),e.jsx(le,{children:e.jsx(ce,{children:"Review"})},"review")]}),e.jsxs(c,{sx:{p:3},children:[Fe(d),e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[e.jsx(A,{variant:"outlined",onClick:we,disabled:d===0,startIcon:e.jsx(is,{}),children:"Back"}),d===T.length?e.jsx(A,{variant:"contained",onClick:Ae,disabled:x,startIcon:x?e.jsx(I,{size:20}):null,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#00635a"},px:3},children:x?"Creating Account...":"Create Account"}):e.jsx(A,{variant:"contained",onClick:Pe,endIcon:e.jsx(os,{}),sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#00635a"}},children:d===T.length-1?"Review":"Next"})]})]}),O&&e.jsx(rs,{variant:"dots",steps:T.length+1,position:"static",activeStep:d,sx:{bgcolor:"background.default"},nextButton:e.jsx("div",{}),backButton:e.jsx("div",{})})]}),e.jsx(c,{sx:{mt:3,textAlign:"center"},children:e.jsxs(a,{variant:"body2",children:["Already have an account?"," ",e.jsx(Ue,{to:"/login",style:{color:V.palette.primary.main,textDecoration:"none",fontWeight:"bold"},children:"Log in"})]})})]})})}export{bs as default};
